-CTE 17.4

-- coeficiente mensual de duración del día D (porcentaje de horas de brillo solar mensual con respecto al año)
CREATE FUNCTION  evot_har_d(double precision) RETURNS double precision 
    AS 'select $1*0.12;'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;

-- fh (humedad relativa mensual/100)
CREATE FUNCTION  evot_har_fh(double precision) RETURNS double precision 
    AS 'select 0.59-0.55*($1^2);'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;
    
-- fw (velocidad m/s (tal como viene))
CREATE FUNCTION  evot_har_fw(double precision) RETURNS double precision 
    AS 'select 0.75+(0.0255*(sqrt($1*0.777*3.6)));'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;

-- fs (brillo solar mensual (tal como viene es decir eje 50.12 ))
-- cte correccion 20
CREATE FUNCTION  evot_har_fs(double precision) RETURNS double precision 
    AS 'select 0.478+0.58*(($1-(($1*20)/100))/100);'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;


-- fe (elevación en metros (tal como viene es decir eje 300m ))
-- cte corre 20
CREATE FUNCTION  evot_har_fe(double precision) RETURNS double precision 
    AS 'select (0.95+0.0001*$1)+((0.95+0.0001*$1)*2)/100;'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;

    
--ETP (porcentaje de horas de brillo solar mensual con respecto al año), temp media mensual,(humedad relativa mensual/100),(velocidad m/s (tal como viene),brillo solar mensual (tal como viene es decir eje 50.12
--- elevación en metros (tal como viene es decir eje 300m, k coeficiente de cultivo)
CREATE FUNCTION  evot_har_evot(double precision,double precision,double precision,double precision,double precision,double precision,double precision) RETURNS double precision 
    AS 'select 17.4*evot_har_d($1)*$2*evot_har_fh($3)*evot_har_fw($4)* evot_har_fs($5)* evot_har_fe($6)*$7;'
    LANGUAGE SQL
    IMMUTABLE
    RETURNS NULL ON NULL INPUT;
